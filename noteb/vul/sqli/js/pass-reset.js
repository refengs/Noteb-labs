$(".next-step").click(function(){$(".verify-phone").hide(),$(".passReset-title").text("重设密码"),$(".reset-pass").show()}),$(".header-info").on("click",".header-info-city",function(){$("#dropdownMenu1").children(".btn-word").text($(this).children("a").text())}),$(".navbar-forum").on("click",".navbar-forum-item",function(){$("#dropdownMenu2").children(".btn-word").text($(this).children("a").text())}),$("#subnav").on("click",".subnav-item",function(){$(this).addClass("active").siblings().removeClass("active")});var user=0,password=0;function checkuser(){var e=$("input[name=name]").val();if(""==e||e.length<3)return user=0,$("#name_error").css("display","block"),!1;user=1,$("#name_error").css("display","none")}function checkpwd(){var e=$("input[name=password]").val();return""==e||e.length<8?(password=0,$("#pwd_error").css("display","block").text("不少于8个字符"),!1):/[\w]$/.test(e)?(password=1,void $("#pwd_error").css("display","none")):(password=0,isMobile()?passPage.showFrame("密码长度不够"):$("#pwd_error").css("display","block").text("含有非法字符"),!1)}function confirms(){var e=$("input[name=password_confirmation]").val(),s=$("input[name=password]").val();""==e||s!=e||e.length<8?(password=0,isMobile()?passPage.showFrame("两次密码不一致"):$("#confirm_error").css("display","block")):(password=1,$("#confirm_error").css("display","none"))}function isMobile(){for(var e=navigator.userAgent,s=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],n=!1,t=0;t<s.length;t++)if(0<e.indexOf(s[t])){n=!0;break}return n}function tijiao(){return 0!=user&&0!=password}$(function(){var e=$("input[name=name]").val();if(e){if(e.length<3)return user=0,$("#name_error").css("display","block"),!1;user=1,$("#name_error").css("display","none")}});var passPage={init:function(){this.isPhone(),this.bindEvent()},showFrame:function(e){$("#message").text(e),$("#myModal").modal()},isPhone:function(){var e=$("#mobile"),s=$("#sendVerifySmsButton"),n=/^1[3456789]\d{9}$/;e.keyup(function(){$("#mobile_error").css("display","none");var e=$(this).val();n.test(e)?($("#mobile_error").css("display","none"),$.ajax({url:"/auth/checkPhone",type:"POST",dataType:"json",data:{_token:$("input[name=token]").val(),mobile:e},success:function(e){if(1==e.status)s.attr("disabled",!1);else{if(s.attr("disabled",!0),!isMobile())return $("#mobile_error").css("display","block").text(e.message),!1;alert(e.message)}},error:function(){if(!isMobile())return $("#mobile_error").css("display","block").text("网络异常"),!1;alert("网络异常")}})):s.attr("disabled",!0)})},bindEvent:function(){$("#sendVerifySmsButton").click(function(){$(this).hasClass("disabled")||$("#TencentCaptcha").trigger("click")})}};$(function(){passPage.init();var n=$("#sendVerifySmsButton"),t=60;window.callback=function(e){0===e.ret&&$.ajax({url:"/auth/obtain/code",type:"post",dataType:"json",data:{_token:$("input[name=token]").val(),type:2,ticket:e.ticket,randstr:e.randstr,mobile:$("input[name=mobile]").val()},success:function(e){if(1==e.success){alert(e.message),n.addClass("disabled");var s=null;s=setInterval(function(){t--,n.text(t+"秒后再次发送"),t<=0&&(clearInterval(s),n.removeClass("disabled"),n.text("再次发送"),t=60)},1e3)}else alert(e.message)}})}});